name: "Deploy prosit 1"

on: 
  push: 
    tags: 
      - "prosit1/v*"

env:
  PROJECT_PATH: prosit1/prosit1.csproj

jobs: 
  deploy:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2

      - uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 3.0.x
      - run: dotnet restore 
      - run: dotnet build -c Release --no-restore

      - run: dotnet publish -c Release --self-contained -r win-x64 -p:PublishSingleFile=true

      - uses: actions/create-release@v1
        id: create_release
        env: 
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN}}
        with: 
          tag_name : ${{ github.ref}}
          release_name : ${{github.ref}}

      - run: pwd && ls
      - uses: csexton/release-asset-action@v2
        with: 
          github-token: ${{ secrets.GITHUB_TOKEN}}
          pattern: prosit1/bin/Release/netcoreapp3.0/win-x64/publish/*.exe
          release-url: ${{ steps.create_release.outputs.upload_url }}



